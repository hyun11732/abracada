<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>AbracaData</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
    <link href='https://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Caesar+Dressing' rel='stylesheet' type='text/css'>
  </head>
  <body onload="author_list()" onload="journal_list">
    <h1><span1 class="fire">A</span1><span1 class="burn">b</span1><span1 class="burn">r</span1><span1 class="burn">a</span1><span1 class="burn">c</span1><span1 class="burn">a</span1><span1 class="burn">-</span1><span1 class="burn">D</span1><span1 class="burn">a</span1><span1 class="burn">t</span1><span1 class="fire">a</span1></h1>
    <h2 style="color:black;">.</h2>
    <div style="float:left;">
      <form>
        <fieldset>
          <legend><h2>Top Trending Authors</h2></legend>
          <ol>
            <li id="rank1"></li>
            <p></p>
            <li id="rank2"></li>
            <p></p>
            <li id="rank3"></li>
          </ol>
        </fieldset>
      </form>
    </div>
    <div style="float:right;">
      <form>
        <fieldset>
          <legend><h2>Top Trending Journals</h2></legend>
          <ol>
            <li id="rank4"></li>
            <p></p>
            <li id="rank5"></li>
            <p></p>
            <li id="rank6"></li>
          </ol>
        </fieldset>
      </form>
    </div>
    <p> </p>
    <p> </p>
    <div>
      <form onSubmit="return false;">
        <fieldset>
          <p>Log in if you would like personalized recommendations!</p>
          <p>
            <label>What is your <b>username</b>?</label>
            <input type = "text"
                   id = "myText81"
                   value = "" />
          </p>
          <button class="button" type="button" style="vertical-align:middle" onclick="login()"><span>Login </span></button>
          <p id="demo1"></p>
        </fieldset>
      </form>
    </div>
    <div>
      <form onSubmit="return false;">
        <fieldset>
          <legend><b>Search For Article</b></legend>
            <p>Search by: </p>
            <label class="container">Article ID
              <input type="radio" checked="checked" name="radio">
              <span class="checkmark"></span>
            </label>
            <label class="container">Author
              <input type="radio" name="radio">
              <span class="checkmark"></span>
            </label>
            <label class="container">University
              <input type="radio" name="radio">
              <span class="checkmark"></span>
            </label>
            <label class="container">Title
              <input type="radio" name="radio" value="1">
              <span class="checkmark"></span>
            </label>
            <label class="container">Year
              <input type="radio" name="radio">
              <span class="checkmark"></span>
            </label>
            <label class="container">Journal
              <input type="radio" name="radio">
              <span class="checkmark"></span>
            </label>
            <label class="container">Field
              <input type="radio" name="radio">
              <span class="checkmark"></span>
            </label>
            <p>
              <input type = "searchtext"
                     id = "myText4"
                     value = "" />
            </p>
          <button class="button" type="button" style="vertical-align:middle" onclick="myFunction()"><span>Search </span></button>
        </fieldset>
      </form>
    </div>
    <div>
      <form onSubmit="return false;">
        <fieldset>
          <legend><b>Insert New Article</b></legend>
          <p>
            <p>What is the <b>name</b> of the article?</p>
            <input type = "searchtext"
                   id = "myText11"
                   value = "" />
          </p>
          <p>
            <p>What is the <b>name</b> of the author?</p>
            <input type = "searchtext"
                   id = "myText12"
                   value = "" />
          </p>
          <p>
            <p>What is the <b>affiliation</b>?</p>
            <input type = "searchtext"
                   id = "myText13"
                   value = "" />
          </p>
          <p>
            <p>What is the <b>Journal Name</b>?</p>
            <input type = "searchtext"
                   id = "myText14"
                   value = "" />
          </p>
          <p>
            <p>What is the <b>publication year</b>?</p>
            <input type = "searchtext"
                   id = "myText15"
                   value = "" />
          </p>
          <p>
            <p>What is the <b>publication url</b>?</p>
            <input type = "searchtext"
                   id = "myText16"
                   value = "" />
          </p>
          <p>
            <p>How many times has this article been <b>cited</b>?</p>
            <input type = "searchtext"
                   id = "myText17"
                   value = "" />
          </p>
          <button class="button" type="button" style="vertical-align:middle" onclick="insert()"><span>Insert </span></button>
        </fieldset>
      </form>
    </div>
    <div>
      <form onSubmit="return false;">
        <fieldset>
          <legend><b>Update Article</b></legend>
          <p>
            <p>What is the <b>Article ID</b>?</p>
            <input type = "searchtext"
                   id = "myText5"
                   value = "" />
          </p>
          <p>What would you like to <b>update?</b></p>
          <label class="container">Number of citations
            <input type="radio" checked="checked" name="radio1">
            <span class="checkmark"></span>
          </label>
          <label class="container">Publication URL
            <input type="radio" name="radio1">
            <span class="checkmark"></span>
          </label>
          <label class="container">Journal Name
            <input type="radio" name="radio1">
            <span class="checkmark"></span>
          </label>
          <p>
            <p>What is the <b>new value</b>?</p>
            <input type = "searchtext"
                   id = "myText7"
                   value = "" />
          </p>
          <button class="button" type="button" style="vertical-align:middle" onclick="update()"><span>Update </span></button>
        </fieldset>
      </form>
    </div>
    <div>
      <form onSubmit="return false;">
        <fieldset>
          <legend><b>Delete Article</b></legend>
          <p>
            <p>What is the <b>Article ID</b>?</p>
            <input type = "searchtext"
                   id = "myText8"
                   value = "" />
          </p>
          <button class="button" type="button" style="vertical-align:middle" onclick="delete2()"><span>Delete </span></button>
        </fieldset>
      </form>
    </div>
    <p id="demo"></p>
    <form id = "result_table"></form>
    <div>
      <form onSubmit="return false;">
        <fieldset>
          <legend><b>Personalized Recommendations</b></legend>
          <p>Recommendations based on:</p>
          <label class="container">Author
            <input type="radio" checked="checked" name="radio2">
            <span class="checkmark"></span>
          </label>
          <label class="container">Field
            <input type="radio" name="radio2">
            <span class="checkmark"></span>
          </label>
          <button class="button" type="button" style="vertical-align:middle" onclick="personal_recommend()"><span>Recommend </span></button>
        </fieldset>
      </form>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
      var user = "";
      function delete2() {
        var article_id = document.getElementById("myText8").value;

        $.post( "/delete", {
          id : article_id }).done(function(data) {
          var stat = data["status"];
          if(stat == "fail") {
            alert("ERROR: No record found")
          } else {
            alert(stat);
          }
        });

      }
      function myFunction() {
        var x = document.getElementById("myText4").value;
        var radios = document.getElementsByName('radio');
        var search_by = 0;
        for (var i = 0, length = radios.length; i < length; i++)
        {
         if (radios[i].checked)
         {
          search_by = i;
          break;
         }
        }
        $.post( "/search", {
                value : x , by : search_by}).done(function(data) {
                  var stat = data["status"];
                  if(stat == "fail") {
                    alert("Error your input is not found");
                  } else {
                    //document.getElementById("result_table").innerHTML = data["data"]
                    var newwin = window.open("", "");
                    newwin.document.write(data["data"]);
                  }
        });

      }
      function insert() {
        var article_name = document.getElementById("myText11").value;
        var author_name = document.getElementById("myText12").value;
        var affiliation = document.getElementById("myText13").value;
        var journal_name = document.getElementById("myText14").value;
        var publication_year = document.getElementById("myText15").value;
        var publication_url = document.getElementById("myText16").value;
        var number_citations = document.getElementById("myText17").value;

        $.post( "/insert", {
                name : article_name , author : author_name , aff : affiliation , j_name : journal_name , pub_year : publication_year , pub_url : publication_url , num_citations : number_citations}).done(function(data) {
                  var stat = data["status"];
                  if(stat == "fail") {
                    alert("ERROR: Could not insert Wrong format")
                  } else {
                    alert(stat);
                  }
        });

      }

      function update() {
        var x = document.getElementById("myText5").value;
        var radios = document.getElementsByName('radio1');
        var d = document.getElementById("myText7").value;
        var search_by = 0
        for (var i = 0, length = radios.length; i < length; i++)
        {
         if (radios[i].checked)
         {
          search_by = i;
          break;
         }
        }
        $.post( "/update", {
                id : x , choice : search_by , value : d}).done(function(data) {
                  var stat = data["status"];
                  if(stat == "fail") {
                    alert("Incorrect article id")
                  } else {
                    alert("success");
                  }
        });

      }
      function login() {
        user = document.getElementById("myText81").value;
        document.getElementById("demo1").innerHTML = "Logged in as "+user;
        $.post( "/login", {
          username : user }).done(function(data) {
          var stat = data["status"];
          if(stat == "fail") {
            alert("ERROR: Something wrong")
          } else {
            alert("Welcome!");
          }
        });

      }
      function personal_recommend() {
        x = user
        var radios = document.getElementsByName('radio2');
        var search_by = 0;
        for (var i = 0, length = radios.length; i < length; i++)
        {
         if (radios[i].checked)
         {
          search_by = i;
          break;
         }
        }
        $.post( "/recom", {
          username : x , by : search_by}).done(function(data) {
          var stat = data["status"];
          if(stat == "fail") {
            alert("ERROR: Please login or search something")
          } else {
            var newwin = window.open("", "");
            newwin.document.write(data["data"]);
          }
        });

      }
      function author_list() {
        $.post( "/rank_author", {
          username : user }).done(function(data) {
          var stat = data["status"];
          if(stat == "fail") {
            alert("ERROR: Could not create new account")
          } else {
            var d = data["data"]
            document.getElementById("rank1").innerHTML = d[1];
            document.getElementById("rank2").innerHTML = d[2];
            document.getElementById("rank3").innerHTML = d[3];
          }
        });
        $.post( "/rank_journal", {
          username : user }).done(function(data) {
          var stat = data["status"];
          if(stat == "fail") {
            alert("ERROR: Could not create new account")
          } else {
            var d = data["data"]
            document.getElementById("rank4").innerHTML = d[1];
            document.getElementById("rank5").innerHTML = d[2];
            document.getElementById("rank6").innerHTML = d[3];
          }
        });

      }
      function journal_list() {
        alert("hello")
        $.post( "/rank_journal", {
          username : user }).done(function(data) {
          var stat = data["status"];
          if(stat == "fail") {
            alert("ERROR: Could not create new account")
          } else {
            var d = data["data"]
            document.getElementById("rank4").innerHTML = d[1];
            document.getElementById("rank5").innerHTML = d[2];
            document.getElementById("rank6").innerHTML = d[3];
          }
        });

      }
    </script>
  </body>
</html>
